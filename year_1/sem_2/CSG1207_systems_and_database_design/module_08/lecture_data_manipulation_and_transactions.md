# Data Manipulation Language and transaction control

## Data Manipulation Language

- Data Manipulation Language (DML) is used to
	- Add / Insert new rows to a table
	- Modify / Update existing rows in a table
	- Remove / Delete existing rows from a table
	- Retrieve / Select rows from table/s
		- Already covered in previous lectures
- Insert, update or delete statements are the core components of **transactions**

### `INSERT` command

**Add a new row to the `job` table:**

![new row to job table](http://snag.gy/2SS0p.jpg)

- The `INSERT` command is used to insert a row into a table
- Two common forms:

``` sql
INSERT [INTO] table_name
VALUES (value1, value2, value3...);
```

- In the form above, a value must be provided for **every column in the table** except `IDENTITY` columns
	- `IDENTITY` value is generated by the server

``` sql
INSERT [INTO] table_name (column1, column2, column3)
VALUES (value1, value2, value3);
```

- In the form above, the column list specifies the names of columns you want to insert into
- Values match the columns named in the column list
- Unspecified columns will get their default value or `NULL`
- Columns set to `NOT NULL` with no default **must be specified a value**

#### Which form to use?

- Functionality is the same for both
- If clarity is an issue, specify the columns
- You can use `NULL` and `DEFAULT` to avoid specifying values
- You must stick to the column order if not specifying column list
	- May cause problems if table structure changes

#### Example `INSERT` statement

``` sql
INSERT INTO job
VALUES ('ST_ASST', 'Stock Assistant', 3000, 6000);
```

``` sql
INSERT INTO job (job_id, job_title, min_salary, max_salary)
VALUES ('ST_ASST', 'Stock Assistant', 3000, 6000)
```

- Obviously, values match the data types of the columns
- Remember to put single quotes around characters and dates

#### Inserting `NULL`, `DEFAULT`, and `IDENTITY` values

- If you omit columns when using a column list, the default value will be used
	- If none has been defined `NULL` is used
	- If no default defined and `NOT NULL` set, the value **cannot be omitted**
- You can specify `NULL` or `DEFAULT` to insert a `NULL` value or the `DEFAULT` value into a column
	- Works regardless of if you specify a column list or not
	- `DEFAULT` only works if a default value is defined
	- If a column allows `NULL` and has no default value set, then it has an implicit default value of `NULL`
		- And hence `DEFAULT` will give the value `NULL`
- You **cannot** specify a value for an `IDENTITY` column
	- The server will generate a value for you
		- Ignore the column

#### `INSERT` examples

``` sql
CREATE TABLE owner (
	owner_id INT IDENTITY PRIMARY KEY,
	name VARCHAR(20) NOT NULL,
	area VARCHAR(30) NULL,
	breeder CHAR(1) NULL DEEFAULT 'N'
);

-- Result: 'Bob', NULL, 'N'
INSERT INTO owner (name)
VALUES ('Bob');

-- Result: 'Sam', NULL, 'N'
INSERT INTO owner
VALUES ('Sam', DEFAULT, DEFAULT);

-- Result: 'Eve', 'Perth', NULL
INSERT INTO owner
VALUES ('Eve', 'Perth', NULL);

-- Result: 'Mary', NULL, Y
INSERT INTO owner
VALUES ('Mary', NULL, 'Y');
```

#### `INSERT` multiple rows

- You can specify multiple sets of values with `,` commas between them in order to insert multiple rows at once:

``` sql
INSERT INTO job (job_id, job_title, min_salary, max_salary)
VALUES	('ST_ASST', 'Stock Assistant', 3000, 6000),
		('DB_ASST', 'Database Assistant', 2500, 7500),
		('DB_ADMIN', 'Database Administrator', 15000, 19000);
```

- Everything we've covered regarding the insertion of asingle row applies exactly the same to inserting multiple rows
- Inserting multiple rows is **not supported** in SQL Server 2005
	- But **is supported** in SQL Server 2008

### Update rows

### Delete rows

### Cascading updates and deletes

## Control transactions
